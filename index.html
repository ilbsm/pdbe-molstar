<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <title>PDBe Molstar</title>

    <!-- Molstar CSS & JS -->
    <link rel="stylesheet" type="text/css" href="build/pdbe-molstar-3.2.3.css">
    <script type="text/javascript" src="build/pdbe-molstar-plugin-3.2.3.js"></script>
    <style>
      * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
      }
      .msp-plugin ::-webkit-scrollbar-thumb {
          background-color: #474748 !important;
      }
      .viewerSection {
        padding-top: 40px;
      }
      .controlsSection {
        width: 300px;
        float: left;
        padding: 40px 0 0 40px;
        margin-right: 30px;
      }
      .controlBox {
        border: 1px solid lightgray;
        padding: 10px;
        margin-bottom: 20px;
      }
      #myViewer{
        float:left;
        width:450px;
        height: 450px;
        position:relative;
      }
    </style>

  </head>

  <body>

    <div class="controlsSection">

      <h3>Canvas/ layout methods</h3>
      
      <div class="controlBox">
        <strong>Set Background</strong><br>
        <button onclick="viewerInstance.canvas.setBgColor({r:255, g:255, b:255})">White</button>&nbsp;
        <button onclick="viewerInstance.canvas.setBgColor({r:0, g:0, b:0})">Black</button><br><br>
        <button onclick="addLasso()">Add lasso</button><br><br>
        <button onclick="deleteLasso()">Remove lasso</button><br><br>
        
        <strong>Toggle controls menu</strong><br>
        <button onclick="viewerInstance.canvas.toggleControls(false)">Hide</button>&nbsp;
        <button onclick="viewerInstance.canvas.toggleControls(true)">Show</button>&nbsp;
        <button onclick="viewerInstance.canvas.toggleControls()">Toggle</button><br><br>
        
        <strong>Toggle Fullscreen</strong><br>
        <button onclick="viewerInstance.canvas.toggleExpanded(true)">Show Fullscreen</button><br>
      </div>

      <h3>Visual Methods</h3>
      <div class="controlBox">
        <strong>Change representation visibility</strong><br>
        <button onclick="viewerInstance.visual.visibility({water:false})">Hide Water Visual</button>&nbsp;
        <button onclick="viewerInstance.visual.visibility({water:true})">Show Water Visual</button><br><br>

        <strong>Toggle Spin</strong><br>
        <button onclick="viewerInstance.visual.toggleSpin(true)">Rotate</button>&nbsp;
        <button onclick="viewerInstance.visual.toggleSpin(false)">Stop</button>&nbsp;
        <button onclick="viewerInstance.visual.toggleSpin()">Toggle</button><br><br>
        
        <strong>Focus</strong><br>
        <button onclick="viewerInstance.visual.focus([{struct_asym_id: 'A', start_residue_number: 14, end_residue_number: 18}])">Focus on Chain A:14-18</button><br><br>

        <strong>Highlight</strong><br>
        <button onclick="viewerInstance.visual.highlight({ data: [{ struct_asym_id: 'A', start_residue_number: 14, end_residue_number: 18 }], color:{r:255,g:255,b:0} })">Highlight Chain A:14-18</button>&nbsp;
        <button onclick="viewerInstance.visual.clearHighlight()">Clear Highlight</button><br><br>
        
        <strong>Selection</strong><br>
        <button onclick="viewerInstance.visual.select({ data: [{ struct_asym_id: 'B', start_residue_number: 1, end_residue_number: 6, color:{r:255,g:255,b:0}, focus: true }]})">Select & Focus on Chain B:1-6</button><br><br>
        <button onclick="
          var selectSections = [
            // {
            //   struct_asym_id: 'B',
            //   unp_accession: 'P00742', 
            //   unp_res_num_start: 235, 
            //   unp_res_num_end: 488, 
            //   color:{r:255,g:0,b:255},
            //   // sideChain: true
            // },
            {
              struct_asym_id: 'C',
              unp_accession: 'P00742', 
              unp_res_num_start: 127, 
              unp_res_num_end: 132, 
              color:{r:255,g:0,b:255},
              // sideChain: true
            }
          ]
          viewerInstance.visual.select({ data: selectSections, nonSelectedColor: {r:255,g:255,b:255}})">Select Uniport</button><br><br>
          
        <button onclick="viewerInstance.visual.select({ data: [{struct_asym_id: 'A', color:{r:255,g:255,b:0}}], nonSelectedColor: {r:255,g:255,b:255} })">Select & Focus on Chain A</button><br><br>

        <button onclick="viewerInstance.visual.clearSelection()">Clear Selection</button><br><br>

        <strong>Set highlight / selection colour</strong><br>
        <button onclick="viewerInstance.visual.setColor({ highlight: {r:255,g:255,b:0} })">Yellow highlight</button>&nbsp;
        <button onclick="viewerInstance.visual.reset({ highlightColor: true })">Reset</button><br><br>
        <button onclick="viewerInstance.visual.setColor({ select: {r:255,g:0,b:0} })">Red selection</button>&nbsp;
        <button onclick="viewerInstance.visual.reset({ selectColor: true })">Reset</button><br><br>
        
        <strong>Reset Visual</strong><br>
        <button onclick="viewerInstance.visual.reset({ camera: true })">Camera</button>&nbsp;
        <button onclick="viewerInstance.visual.reset({ theme: true })">Theme</button>&nbsp;
        <button onclick="viewerInstance.visual.reset({ camera: true, theme: true })">Camera & Theme</button><br><br>

        <strong>Update data</strong><br>
        <button onclick="viewerInstance.visual.update({moleculeId: '1cbs'}, false)">Update data to create new visual</button><br>
      
      </div>

    </div>

    <div class="viewerSection">
      <h4>PDBe Mol* JS Plugin Demo</h4>

      <!-- Molstar container -->
      <div id="myViewer"></div>
      
    </div>
    <script>

      // Create plugin instance
      var viewerInstance = new PDBeMolstarPlugin();
  
      // Set options (Checkout available options list in the documentation)
      // var options = {
      //   moleculeId: '1cbs',
      //   // expanded: true,
      //   // loadMaps: true,
      //   bgColor: {r:255, g:255, b:255},
      //   // hideControls: true,
      //   // domainAnnotation: true,
      //   // validationAnnotation: true,
      //   // symmetryAnnotation: true,
      //   // subscribeEvents: true,
      //   loadingOverlay: true,
      // };

      // // Ligand view 
      // var options = {
      //   moleculeId: '1cbs',
      //   ligandView: {label_comp_id: "REA"},
      //   loadMaps: true,
      //   expanded: false,
      //   hideControls: true,
      //   bgColor: {r:255, g:255, b:255},
      // };

      // // Superposition options (P08083, Q14676, Q5VSL9, P54646)
      // var options = {
      //   moleculeId: 'P08684',
      //   superposition: true,
      //   expanded: true,
      //   // hideControls: true,
      //   bgColor: {r:255, g:255, b:255},
      //   superpositionParams: { matrixAccession: 'P08684', segment:1, ligandView: false },
      //   loadingOverlay: true,
      // };

      // AF
      var options = {
        customData: {
          url: 'https://alphafold.ebi.ac.uk/files/AF-L7LR50-F1-model_v4.cif',
          format: 'cif'
        },
        bgColor: {r:255, g:255, b:255},

        // hideControls: true,
        alphafoldView: false,
        hideCanvasControls: ['selection', 'animation', 'controlToggle', 'controlInfo']
      };
      
      // Get element from HTML/Template to place the viewer 
      var viewerContainer = document.getElementById('myViewer');
  
      // Call render method to display the 3D view
      viewerInstance.render(viewerContainer, options);
      var surface;
      var bond;
      function deleteLasso(){
        surface.then(x => viewerInstance.deleteStructure(x));
        bond.then(x => viewerInstance.deleteStructure(x));
      }
      function addLasso(){
        const coords = [[[-23.301, -2.022, 12.006], [-22.8011, -2.54475, 8.41526], [-20.9854, -2.63196, 11.5802]], 
                    [[-23.301, -2.022, 12.006], [-20.9854, -2.63196, 11.5802], [-20.6865, -3.21803, 14.2324]], 
                    [[-24.123, -1.762, 6.673], [-22.8011, -2.54475, 8.41526], [-26.424, -1.755, 9.761]], 
                    [[-23.301, -2.022, 12.006], [-26.424, -1.755, 9.761], [-22.8011, -2.54475, 8.41526]], 
                    [[-24.997, -3.407, 3.336], [-22.5459, -5.67178, 3.26823], [-21.7866, -3.88311, 5.84594]], 
                    [[-24.123, -1.762, 6.673], [-21.7866, -3.88311, 5.84594], [-22.8011, -2.54475, 8.41526]], 
                    [[-23.689, -6.938, 2.859], [-22.5459, -5.67178, 3.26823], [-24.997, -3.407, 3.336]], 
                    [[-24.997, -3.407, 3.336], [-21.7866, -3.88311, 5.84594], [-24.123, -1.762, 6.673]], 
                    [[-21.051, -6.791, 0.114], [-22.5459, -5.67178, 3.26823], [-23.689, -6.938, 2.859]], 
                    [[-21.051, -6.791, 0.114], [-19.4, -6.245, 2.25535], [-22.5459, -5.67178, 3.26823]], 
                    [[-21.613, -9.637, -2.394], [-19.5347, -7.86917, -0.858877], [-21.051, -6.791, 0.114]], 
                    [[-21.051, -6.791, 0.114], [-19.5347, -7.86917, -0.858877], [-19.4, -6.245, 2.25535]], 
                    [[-18.069, -9.226, -3.846], [-19.5347, -7.86917, -0.858877], [-21.613, -9.637, -2.394]], 
                    [[-18.069, -9.226, -3.846], [-16.8982, -7.53232, 0.154603], [-19.5347, -7.86917, -0.858877]], 
                    [[-15.084, -9.091, -1.484], [-16.8982, -7.53232, 0.154603], [-18.069, -9.226, -3.846]], 
                    [[-14.1538, -7.05154, 0.775304], [-15.708, -5.54543, 4.44554], [-16.8982, -7.53232, 0.154603]], 
                    [[-15.084, -9.091, -1.484], [-11.9102, -7.33789, -1.05223], [-14.1538, -7.05154, 0.775304]], 
                    [[-15.084, -9.091, -1.484], [-14.1538, -7.05154, 0.775304], [-16.8982, -7.53232, 0.154603]], 
                    [[-8.646, -7.964, -0.64], [-11.9102, -7.33789, -1.05223], [-11.842, -7.466, -2.648]], 
                    [[-11.842, -7.466, -2.648], [-11.9102, -7.33789, -1.05223], [-15.084, -9.091, -1.484]], 
                    [[-8.646, -7.964, -0.64], [-7.65045, -5.63701, 0.808641], [-10.0696, -6.43625, 0.890841]], 
                    [[-8.646, -7.964, -0.64], [-10.0696, -6.43625, 0.890841], [-11.9102, -7.33789, -1.05223]], 
                    [[-6.111, -5.08, -0.686], [-3.5493, -4.16283, 1.64701], [-7.65045, -5.63701, 0.808641]], 
                    [[-6.111, -5.08, -0.686], [-7.65045, -5.63701, 0.808641], [-8.646, -7.964, -0.64]], 
                    [[-1.14, -1.951, 0.41], [-3.5493, -4.16283, 1.64701], [-2.593, -5.483, 0.783]], 
                    [[-2.593, -5.483, 0.783], [-3.5493, -4.16283, 1.64701], [-6.111, -5.08, -0.686]], 
                    [[-0.783, -0.027, 3.724], [-3.37552, -2.64214, 4.56739], [-1.14, -1.951, 0.41]], 
                    [[-1.14, -1.951, 0.41], [-3.37552, -2.64214, 4.56739], [-3.5493, -4.16283, 1.64701]], 
                    [[-2.917, -2.31, 5.949], [-4.88831, -2.53587, 6.21548], [-3.37552, -2.64214, 4.56739]], 
                    [[-2.917, -2.31, 5.949], [-3.37552, -2.64214, 4.56739], [-0.783, -0.027, 3.724]], 
                    [[-5.39, -0.994, 8.557], [-4.88831, -2.53587, 6.21548], [-2.917, -2.31, 5.949]], 
                    [[-5.39, -0.994, 8.557], [-7.57318, -3.08223, 7.54741], [-4.88831, -2.53587, 6.21548]], 
                    [[-6.867, -1.768, 11.986], [-7.57318, -3.08223, 7.54741], [-5.39, -0.994, 8.557]], 
                    [[-6.867, -1.768, 11.986], [-9.10072, -3.69314, 9.92887], [-7.57318, -3.08223, 7.54741]], 
                    [[-9.557, -4.457, 11.372], [-9.10072, -3.69314, 9.92887], [-6.867, -1.768, 11.986]], 
                    [[-9.557, -4.457, 11.372], [-12.0915, -4.37305, 10.0586], [-9.10072, -3.69314, 9.92887]], 
                    [[-12.255, -5.515, 13.861], [-13.2151, -5.13548, 12.2527], [-9.557, -4.457, 11.372]], 
                    [[-9.557, -4.457, 11.372], [-13.2151, -5.13548, 12.2527], [-12.0915, -4.37305, 10.0586]], 
                    [[-11.921, -9.013, 15.363], [-13.1871, -6.54963, 14.0902], [-12.255, -5.515, 13.861]], 
                    [[-12.255, -5.515, 13.861], [-13.1871, -6.54963, 14.0902], [-13.2151, -5.13548, 12.2527]], 
                    [[-11.921, -9.013, 15.363], [-14.4278, -7.38663, 14.6584], [-13.1871, -6.54963, 14.0902]], 
                    [[-14.193, -11.815, 14.02], [-14.4278, -7.38663, 14.6584], [-11.921, -9.013, 15.363]], 
                    [[-14.193, -11.815, 14.02], [-16.1484, -8.1403, 15.1548], [-14.4278, -7.38663, 14.6584]], 
                    [[-17.762, -11.239, 15.361], [-16.1484, -8.1403, 15.1548], [-14.193, -11.815, 14.02]], 
                    [[-17.225, -7.471, 16.005], [-16.1484, -8.1403, 15.1548], [-17.762, -11.239, 15.361]], 
                    [[-17.225, -7.471, 16.005], [-16.3566, -6.90685, 14.8325], [-16.1484, -8.1403, 15.1548]], 
                    [[-18.847, -4.76, 13.86], [-17.0974, -4.01322, 12.7424], [-16.3566, -6.90685, 14.8325]], 
                    [[-18.847, -4.76, 13.86], [-16.3566, -6.90685, 14.8325], [-17.225, -7.471, 16.005]], 
                    [[-17.414, -1.44, 12.671], [-17.0974, -4.01322, 12.7424], [-18.847, -4.76, 13.86]], 
                    [[-17.414, -1.44, 12.671], [-16.6929, -2.15937, 11.4769], [-17.0974, -4.01322, 12.7424]], 
                    [[-19.216, 1.718, 13.876], [-17.3345, 0.061792, 12.6475], [-17.414, -1.44, 12.671]], 
                    [[-17.414, -1.44, 12.671], [-17.3345, 0.061792, 12.6475], [-16.6929, -2.15937, 11.4769]], 
                    [[-18.186, 5.367, 13.33], [-17.2145, 3.33202, 13.5707], [-19.216, 1.718, 13.876]], 
                    [[-19.216, 1.718, 13.876], [-17.2145, 3.33202, 13.5707], [-17.8479, 1.29501, 13.2145]], 
                    [[-18.705, 7.723, 16.316], [-17.2145, 3.33202, 13.5707], [-18.186, 5.367, 13.33]], 
                    [[-19.216, 1.718, 13.876], [-17.8479, 1.29501, 13.2145], [-17.3345, 0.061792, 12.6475]], 
                    [[-17.478, 11.37, 16.246], [-16.6952, 5.65451, 14.6441], [-18.705, 7.723, 16.316]], 
                    [[-18.705, 7.723, 16.316], [-16.6952, 5.65451, 14.6441], [-17.2145, 3.33202, 13.5707]], 
                    [[-17.478, 11.37, 16.246], [-16.0587, 8.65002, 14.8581], [-16.6952, 5.65451, 14.6441]], 
                    [[-15.466, 10.551, 13.057], [-16.0587, 8.65002, 14.8581], [-17.478, 11.37, 16.246]], 
                    [[-13.576, 7.699, 14.873], [-16.0587, 8.65002, 14.8581], [-15.466, 10.551, 13.057]], 
                    [[-13.576, 7.699, 14.873], [-15.3312, 3.67678, 14.1878], [-16.0587, 8.65002, 14.8581]], 
                    [[-13.688, 3.98, 14.014], [-15.3312, 3.67678, 14.1878], [-13.576, 7.699, 14.873]], 
                    [[-13.688, 3.98, 14.014], [-15.9671, 2.06121, 14.3985], [-15.3312, 3.67678, 14.1878]], 
                    [[-14.846, 1.684, 16.834], [-15.9671, 2.06121, 14.3985], [-13.688, 3.98, 14.014]], 
                    [[-14.846, 1.684, 16.834], [-16.2749, -0.47657, 14.7614], [-15.9671, 2.06121, 14.3985]], 
                    [[-15.327, -2.099, 16.943], [-16.2749, -0.47657, 14.7614], [-14.846, 1.684, 16.834]], 
                    [[-15.327, -2.099, 16.943], [-16.8343, -2.18393, 16.1611], [-16.2749, -0.47657, 14.7614]], 
                    [[-18.395, -3.192, 18.945], [-16.8343, -2.18393, 16.1611], [-15.327, -2.099, 16.943]], 
                    [[-19.521, -3.94661, 17.4997], [-17.6241, -2.16175, 14.4102], [-16.8343, -2.18393, 16.1611]], 
                    [[-20.142, -6.536, 19.617], [-19.521, -3.94661, 17.4997], [-18.395, -3.192, 18.945]], 
                    [[-18.395, -3.192, 18.945], [-19.521, -3.94661, 17.4997], [-16.8343, -2.18393, 16.1611]], 
                    [[-23.427, -7.084, 17.636], [-21.1203, -4.32993, 16.2085], [-20.142, -6.536, 19.617]], 
                    [[-20.142, -6.536, 19.617], [-21.1203, -4.32993, 16.2085], [-19.521, -3.94661, 17.4997]], 
                    [[-23.427, -7.084, 17.636], [-23.8105, -4.49594, 18.3471], [-21.8011, -4.6503, 16.6151]], 
                    [[-23.427, -7.084, 17.636], [-21.8011, -4.6503, 16.6151], [-21.1203, -4.32993, 16.2085]], 
                    [[-23.979, -2.722, 20.793], [-23.8105, -4.49594, 18.3471], [-25.653, -6.206, 20.658]], 
                    [[-25.653, -6.206, 20.658], [-23.8105, -4.49594, 18.3471], [-23.427, -7.084, 17.636]], 
                    [[-24.847, -1.845, 17.173], [-23.8723, -3.27124, 17.3983], [-23.979, -2.722, 20.793]], 
                    [[-23.979, -2.722, 20.793], [-23.8723, -3.27124, 17.3983], [-23.8105, -4.49594, 18.3471]], 
                    [[-24.074, -1.9335, 14.5895], [-23.8723, -3.27124, 17.3983], [-24.847, -1.845, 17.173]], 
                    [[-24.074, -1.9335, 14.5895], [-20.6865, -3.21803, 14.2324], [-23.8723, -3.27124, 17.3983]], 
                    [[-23.301, -2.022, 12.006], [-20.6865, -3.21803, 14.2324], [-24.074, -1.9335, 14.5895]], 
                    [[-20.9854, -2.63196, 11.5802], [-19.0454, -2.66264, 12.3056], [-20.6865, -3.21803, 14.2324]], 
                    [[-22.8011, -2.54475, 8.41526], [-18.57, -3.98599, 7.43642], [-20.9854, -2.63196, 11.5802]], 
                    [[-20.9854, -2.63196, 11.5802], [-18.57, -3.98599, 7.43642], [-19.0454, -2.66264, 12.3056]], 
                    [[-22.8011, -2.54475, 8.41526], [-21.7866, -3.88311, 5.84594], [-18.57, -3.98599, 7.43642]], 
                    [[-19.4, -6.245, 2.25535], [-18.57, -3.98599, 7.43642], [-21.7866, -3.88311, 5.84594]], 
                    [[-19.4, -6.245, 2.25535], [-21.7866, -3.88311, 5.84594], [-22.5459, -5.67178, 3.26823]], 
                    [[-16.8982, -7.53232, 0.154603], [-18.57, -3.98599, 7.43642], [-19.4, -6.245, 2.25535]], 
                    [[-16.8982, -7.53232, 0.154603], [-19.4, -6.245, 2.25535], [-19.5347, -7.86917, -0.858877]], 
                    [[-16.8982, -7.53232, 0.154603], [-15.708, -5.54543, 4.44554], [-18.57, -3.98599, 7.43642]], 
                    [[-14.1538, -7.05154, 0.775304], [-12.5076, -4.70516, 7.05081], [-15.708, -5.54543, 4.44554]], 
                    [[-10.0696, -6.43625, 0.890841], [-12.5076, -4.70516, 7.05081], [-14.1538, -7.05154, 0.775304]], 
                    [[-10.0696, -6.43625, 0.890841], [-14.1538, -7.05154, 0.775304], [-11.9102, -7.33789, -1.05223]], 
                    [[-3.37552, -2.64214, 4.56739], [-12.5076, -4.70516, 7.05081], [-7.65045, -5.63701, 0.808641]], 
                    [[-3.37552, -2.64214, 4.56739], [-7.65045, -5.63701, 0.808641], [-3.5493, -4.16283, 1.64701]], 
                    [[-7.65045, -5.63701, 0.808641], [-12.5076, -4.70516, 7.05081], [-10.0696, -6.43625, 0.890841]], 
                    [[-7.57318, -3.08223, 7.54741], [-3.37552, -2.64214, 4.56739], [-4.88831, -2.53587, 6.21548]], 
                    [[-7.57318, -3.08223, 7.54741], [-12.5076, -4.70516, 7.05081], [-3.37552, -2.64214, 4.56739]], 
                    [[-9.10072, -3.69314, 9.92887], [-12.5076, -4.70516, 7.05081], [-7.57318, -3.08223, 7.54741]], 
                    [[-12.0915, -4.37305, 10.0586], [-12.5076, -4.70516, 7.05081], [-9.10072, -3.69314, 9.92887]], 
                    [[-13.2151, -5.13548, 12.2527], [-14.1394, -3.95131, 10.5939], [-12.0915, -4.37305, 10.0586]], 
                    [[-14.4278, -7.38663, 14.6584], [-14.1394, -3.95131, 10.5939], [-13.2151, -5.13548, 12.2527]], 
                    [[-14.4278, -7.38663, 14.6584], [-13.2151, -5.13548, 12.2527], [-13.1871, -6.54963, 14.0902]], 
                    [[-17.0974, -4.01322, 12.7424], [-16.3662, -3.21763, 11.2521], [-14.4278, -7.38663, 14.6584]], 
                    [[-16.3566, -6.90685, 14.8325], [-14.4278, -7.38663, 14.6584], [-16.1484, -8.1403, 15.1548]], 
                    [[-17.0974, -4.01322, 12.7424], [-14.4278, -7.38663, 14.6584], [-16.3566, -6.90685, 14.8325]], 
                    [[-16.6929, -2.15937, 11.4769], [-16.3662, -3.21763, 11.2521], [-17.0974, -4.01322, 12.7424]], 
                    [[-17.2145, 3.33202, 13.5707], [-16.3662, -3.21763, 11.2521], [-16.6929, -2.15937, 11.4769]], 
                    [[-17.2145, 3.33202, 13.5707], [-17.3345, 0.061792, 12.6475], [-17.8479, 1.29501, 13.2145]], 
                    [[-17.2145, 3.33202, 13.5707], [-16.6929, -2.15937, 11.4769], [-17.3345, 0.061792, 12.6475]], 
                    [[-15.9671, 2.06121, 14.3985], [-15.8748, -0.698062, 11.5793], [-17.2145, 3.33202, 13.5707]], 
                    [[-15.3312, 3.67678, 14.1878], [-16.6952, 5.65451, 14.6441], [-16.0587, 8.65002, 14.8581]], 
                    [[-15.3312, 3.67678, 14.1878], [-17.2145, 3.33202, 13.5707], [-16.6952, 5.65451, 14.6441]], 
                    [[-15.9671, 2.06121, 14.3985], [-17.2145, 3.33202, 13.5707], [-15.3312, 3.67678, 14.1878]], 
                    [[-16.2749, -0.47657, 14.7614], [-15.8748, -0.698062, 11.5793], [-15.9671, 2.06121, 14.3985]], 
                    [[-16.2749, -0.47657, 14.7614], [-17.6241, -2.16175, 14.4102], [-15.8748, -0.698062, 11.5793]], 
                    [[-16.8343, -2.18393, 16.1611], [-17.6241, -2.16175, 14.4102], [-16.2749, -0.47657, 14.7614]], 
                    [[-21.1203, -4.32993, 16.2085], [-17.3167, -1.91468, 13.0492], [-17.6241, -2.16175, 14.4102]], 
                    [[-21.1203, -4.32993, 16.2085], [-17.6241, -2.16175, 14.4102], [-19.521, -3.94661, 17.4997]], 
                    [[-20.6865, -3.21803, 14.2324], [-17.3167, -1.91468, 13.0492], [-21.1203, -4.32993, 16.2085]], 
                    [[-23.8723, -3.27124, 17.3983], [-21.8011, -4.6503, 16.6151], [-23.8105, -4.49594, 18.3471]], 
                    [[-23.8723, -3.27124, 17.3983], [-21.1203, -4.32993, 16.2085], [-21.8011, -4.6503, 16.6151]], 
                    [[-20.6865, -3.21803, 14.2324], [-21.1203, -4.32993, 16.2085], [-23.8723, -3.27124, 17.3983]], 
                    [[-20.6865, -3.21803, 14.2324], [-19.0454, -2.66264, 12.3056], [-17.3167, -1.91468, 13.0492]], 
                    [[-18.57, -3.98599, 7.43642], [-15.708, -5.54543, 4.44554], [-12.5076, -4.70516, 7.05081]], 
                    [[-18.57, -3.98599, 7.43642], [-12.5076, -4.70516, 7.05081], [-16.6673, -3.1262, 11.2656]], 
                    [[-12.0915, -4.37305, 10.0586], [-14.1394, -3.95131, 10.5939], [-12.5076, -4.70516, 7.05081]], 
                    [[-14.1394, -3.95131, 10.5939], [-16.6673, -3.1262, 11.2656], [-12.5076, -4.70516, 7.05081]], 
                    [[-14.4278, -7.38663, 14.6584], [-16.3662, -3.21763, 11.2521], [-14.1394, -3.95131, 10.5939]], 
                    [[-16.3662, -3.21763, 11.2521], [-16.6673, -3.1262, 11.2656], [-14.1394, -3.95131, 10.5939]], 
                    [[-17.2145, 3.33202, 13.5707], [-15.8748, -0.698062, 11.5793], [-16.3662, -3.21763, 11.2521]], 
                    [[-15.8748, -0.698062, 11.5793], [-16.6673, -3.1262, 11.2656], [-16.3662, -3.21763, 11.2521]], 
                    [[-17.3167, -1.91468, 13.0492], [-15.8748, -0.698062, 11.5793], [-17.6241, -2.16175, 14.4102]], 
                    [[-17.3167, -1.91468, 13.0492], [-16.6673, -3.1262, 11.2656], [-15.8748, -0.698062, 11.5793]], 
                    [[-19.0454, -2.66264, 12.3056], [-16.6673, -3.1262, 11.2656], [-17.3167, -1.91468, 13.0492]], 
                    [[-18.57, -3.98599, 7.43642], [-16.6673, -3.1262, 11.2656], [-19.0454, -2.66264, 12.3056]], 
                    [[-18.57, -3.98599, 7.43642], [-16.6673, -3.1262, 11.2656], [-19.0454, -2.66264, 12.3056]]]
        const coords2 = [[[-3.301, -2.022, 12.006], [-22.8011, -2.54475, 8.41526], [-20.9854, -2.63196, 11.5802]], 
                    [[-23.301, -2.022, 12.006], [-20.9854, -2.63196, 11.5802], [-20.6865, -3.21803, 14.2324]], 
                    [[-4.123, -1.762, 6.673], [-22.8011, -2.54475, 8.41526], [-26.424, -1.755, 9.761]], 
                    [[-23.301, -2.022, 12.006], [-26.424, -1.755, 9.761], [-22.8011, -2.54475, 8.41526]], 
                    [[-24.997, -3.407, 3.336], [-22.5459, -5.67178, 3.26823], [-21.7866, -3.88311, 5.84594]], 
                    [[-24.123, -1.762, 6.673], [-21.7866, -3.88311, 5.84594], [-22.8011, -2.54475, 8.41526]], 
                    [[-23.689, -6.938, 2.859], [-22.5459, -5.67178, 3.26823], [-24.997, -3.407, 3.336]], 
                    [[-24.997, -3.407, 3.336], [-21.7866, -3.88311, 5.84594], [-24.123, -1.762, 6.673]], 
                    [[-21.051, -6.791, 0.114], [-22.5459, -5.67178, 3.26823], [-23.689, -6.938, 2.859]], 
                    [[-21.051, -6.791, 0.114], [-19.4, -6.245, 2.25535], [-22.5459, -5.67178, 3.26823]], 
                    [[-21.613, -9.637, -2.394], [-19.5347, -7.86917, -0.858877], [-21.051, -6.791, 0.114]], 
                    [[-21.051, -6.791, 0.114], [-19.5347, -7.86917, -0.858877], [-19.4, -6.245, 2.25535]], 
                    [[-18.069, -9.226, -3.846], [-19.5347, -7.86917, -0.858877], [-21.613, -9.637, -2.394]], 
                    [[-18.069, -9.226, -3.846], [-16.8982, -7.53232, 0.154603], [-19.5347, -7.86917, -0.858877]], 
                    [[-15.084, -9.091, -1.484], [-16.8982, -7.53232, 0.154603], [-18.069, -9.226, -3.846]], 
                    [[-14.1538, -7.05154, 0.775304], [-15.708, -5.54543, 4.44554], [-16.8982, -7.53232, 0.154603]], 
                    [[-15.084, -9.091, -1.484], [-11.9102, -7.33789, -1.05223], [-14.1538, -7.05154, 0.775304]], 
                    [[-15.084, -9.091, -1.484], [-14.1538, -7.05154, 0.775304], [-16.8982, -7.53232, 0.154603]], 
                    [[-8.646, -7.964, -0.64], [-11.9102, -7.33789, -1.05223], [-11.842, -7.466, -2.648]], 
                    [[-11.842, -7.466, -2.648], [-11.9102, -7.33789, -1.05223], [-15.084, -9.091, -1.484]], 
                    [[-8.646, -7.964, -0.64], [-7.65045, -5.63701, 0.808641], [-10.0696, -6.43625, 0.890841]], 
                    [[-8.646, -7.964, -0.64], [-10.0696, -6.43625, 0.890841], [-11.9102, -7.33789, -1.05223]], 
                    [[-6.111, -5.08, -0.686], [-3.5493, -4.16283, 1.64701], [-7.65045, -5.63701, 0.808641]], 
                    [[-6.111, -5.08, -0.686], [-7.65045, -5.63701, 0.808641], [-8.646, -7.964, -0.64]], 
                    [[-1.14, -1.951, 0.41], [-3.5493, -4.16283, 1.64701], [-2.593, -5.483, 0.783]], 
                    [[-2.593, -5.483, 0.783], [-3.5493, -4.16283, 1.64701], [-6.111, -5.08, -0.686]], 
                    [[-0.783, -0.027, 3.724], [-3.37552, -2.64214, 4.56739], [-1.14, -1.951, 0.41]], 
                    [[-1.14, -1.951, 0.41], [-3.37552, -2.64214, 4.56739], [-3.5493, -4.16283, 1.64701]], 
                    [[-2.917, -2.31, 5.949], [-4.88831, -2.53587, 6.21548], [-3.37552, -2.64214, 4.56739]], 
                    [[-2.917, -2.31, 5.949], [-3.37552, -2.64214, 4.56739], [-0.783, -0.027, 3.724]], 
                    [[-5.39, -0.994, 8.557], [-4.88831, -2.53587, 6.21548], [-2.917, -2.31, 5.949]], 
                    [[-5.39, -0.994, 8.557], [-7.57318, -3.08223, 7.54741], [-4.88831, -2.53587, 6.21548]], 
                    [[-6.867, -1.768, 11.986], [-7.57318, -3.08223, 7.54741], [-5.39, -0.994, 8.557]], 
                    [[-6.867, -1.768, 11.986], [-9.10072, -3.69314, 9.92887], [-7.57318, -3.08223, 7.54741]], 
                    [[-9.557, -4.457, 11.372], [-9.10072, -3.69314, 9.92887], [-6.867, -1.768, 11.986]], 
                    [[-9.557, -4.457, 11.372], [-12.0915, -4.37305, 10.0586], [-9.10072, -3.69314, 9.92887]], 
                    [[-12.255, -5.515, 13.861], [-13.2151, -5.13548, 12.2527], [-9.557, -4.457, 11.372]], 
                    [[-9.557, -4.457, 11.372], [-13.2151, -5.13548, 12.2527], [-12.0915, -4.37305, 10.0586]], 
                    [[-11.921, -9.013, 15.363], [-13.1871, -6.54963, 14.0902], [-12.255, -5.515, 13.861]], 
                    [[-12.255, -5.515, 13.861], [-13.1871, -6.54963, 14.0902], [-13.2151, -5.13548, 12.2527]], 
                    [[-11.921, -9.013, 15.363], [-14.4278, -7.38663, 14.6584], [-13.1871, -6.54963, 14.0902]], 
                    [[-14.193, -11.815, 14.02], [-14.4278, -7.38663, 14.6584], [-11.921, -9.013, 15.363]], 
                    [[-14.193, -11.815, 14.02], [-16.1484, -8.1403, 15.1548], [-14.4278, -7.38663, 14.6584]], 
                    [[-17.762, -11.239, 15.361], [-16.1484, -8.1403, 15.1548], [-14.193, -11.815, 14.02]], 
                    [[-17.225, -7.471, 16.005], [-16.1484, -8.1403, 15.1548], [-17.762, -11.239, 15.361]], 
                    [[-17.225, -7.471, 16.005], [-16.3566, -6.90685, 14.8325], [-16.1484, -8.1403, 15.1548]], 
                    [[-18.847, -4.76, 13.86], [-17.0974, -4.01322, 12.7424], [-16.3566, -6.90685, 14.8325]], 
                    [[-18.847, -4.76, 13.86], [-16.3566, -6.90685, 14.8325], [-17.225, -7.471, 16.005]], 
                    [[-17.414, -1.44, 12.671], [-17.0974, -4.01322, 12.7424], [-18.847, -4.76, 13.86]], 
                    [[-17.414, -1.44, 12.671], [-16.6929, -2.15937, 11.4769], [-17.0974, -4.01322, 12.7424]], 
                    [[-19.216, 1.718, 13.876], [-17.3345, 0.061792, 12.6475], [-17.414, -1.44, 12.671]], 
                    [[-17.414, -1.44, 12.671], [-17.3345, 0.061792, 12.6475], [-16.6929, -2.15937, 11.4769]], 
                    [[-18.186, 5.367, 13.33], [-17.2145, 3.33202, 13.5707], [-19.216, 1.718, 13.876]], 
                    [[-19.216, 1.718, 13.876], [-17.2145, 3.33202, 13.5707], [-17.8479, 1.29501, 13.2145]], 
                    [[-18.705, 7.723, 16.316], [-17.2145, 3.33202, 13.5707], [-18.186, 5.367, 13.33]], 
                    [[-19.216, 1.718, 13.876], [-17.8479, 1.29501, 13.2145], [-17.3345, 0.061792, 12.6475]], 
                    [[-17.478, 11.37, 16.246], [-16.6952, 5.65451, 14.6441], [-18.705, 7.723, 16.316]], 
                    [[-18.705, 7.723, 16.316], [-16.6952, 5.65451, 14.6441], [-17.2145, 3.33202, 13.5707]], 
                    [[-17.478, 11.37, 16.246], [-16.0587, 8.65002, 14.8581], [-16.6952, 5.65451, 14.6441]], 
                    [[-15.466, 10.551, 13.057], [-16.0587, 8.65002, 14.8581], [-17.478, 11.37, 16.246]], 
                    [[-13.576, 7.699, 14.873], [-16.0587, 8.65002, 14.8581], [-15.466, 10.551, 13.057]], 
                    [[-13.576, 7.699, 14.873], [-15.3312, 3.67678, 14.1878], [-16.0587, 8.65002, 14.8581]], 
                    [[-13.688, 3.98, 14.014], [-15.3312, 3.67678, 14.1878], [-13.576, 7.699, 14.873]], 
                    [[-13.688, 3.98, 14.014], [-15.9671, 2.06121, 14.3985], [-15.3312, 3.67678, 14.1878]], 
                    [[-14.846, 1.684, 16.834], [-15.9671, 2.06121, 14.3985], [-13.688, 3.98, 14.014]], 
                    [[-14.846, 1.684, 16.834], [-16.2749, -0.47657, 14.7614], [-15.9671, 2.06121, 14.3985]], 
                    [[-15.327, -2.099, 16.943], [-16.2749, -0.47657, 14.7614], [-14.846, 1.684, 16.834]], 
                    [[-15.327, -2.099, 16.943], [-16.8343, -2.18393, 16.1611], [-16.2749, -0.47657, 14.7614]], 
                    [[-18.395, -3.192, 18.945], [-16.8343, -2.18393, 16.1611], [-15.327, -2.099, 16.943]], 
                    [[-19.521, -3.94661, 17.4997], [-17.6241, -2.16175, 14.4102], [-16.8343, -2.18393, 16.1611]], 
                    [[-20.142, -6.536, 19.617], [-19.521, -3.94661, 17.4997], [-18.395, -3.192, 18.945]], 
                    [[-18.395, -3.192, 18.945], [-19.521, -3.94661, 17.4997], [-16.8343, -2.18393, 16.1611]], 
                    [[-23.427, -7.084, 17.636], [-21.1203, -4.32993, 16.2085], [-20.142, -6.536, 19.617]], 
                    [[-20.142, -6.536, 19.617], [-21.1203, -4.32993, 16.2085], [-19.521, -3.94661, 17.4997]], 
                    [[-23.427, -7.084, 17.636], [-23.8105, -4.49594, 18.3471], [-21.8011, -4.6503, 16.6151]], 
                    [[-23.427, -7.084, 17.636], [-21.8011, -4.6503, 16.6151], [-21.1203, -4.32993, 16.2085]], 
                    [[-23.979, -2.722, 20.793], [-23.8105, -4.49594, 18.3471], [-25.653, -6.206, 20.658]], 
                    [[-25.653, -6.206, 20.658], [-23.8105, -4.49594, 18.3471], [-23.427, -7.084, 17.636]], 
                    [[-24.847, -1.845, 17.173], [-23.8723, -3.27124, 17.3983], [-23.979, -2.722, 20.793]], 
                    [[-23.979, -2.722, 20.793], [-23.8723, -3.27124, 17.3983], [-23.8105, -4.49594, 18.3471]], 
                    [[-24.074, -1.9335, 14.5895], [-23.8723, -3.27124, 17.3983], [-24.847, -1.845, 17.173]], 
                    [[-24.074, -1.9335, 14.5895], [-20.6865, -3.21803, 14.2324], [-23.8723, -3.27124, 17.3983]], 
                    [[-23.301, -2.022, 12.006], [-20.6865, -3.21803, 14.2324], [-24.074, -1.9335, 14.5895]], 
                    [[-20.9854, -2.63196, 11.5802], [-19.0454, -2.66264, 12.3056], [-20.6865, -3.21803, 14.2324]], 
                    [[-22.8011, -2.54475, 8.41526], [-18.57, -3.98599, 7.43642], [-20.9854, -2.63196, 11.5802]], 
                    [[-20.9854, -2.63196, 11.5802], [-18.57, -3.98599, 7.43642], [-19.0454, -2.66264, 12.3056]], 
                    [[-22.8011, -2.54475, 8.41526], [-21.7866, -3.88311, 5.84594], [-18.57, -3.98599, 7.43642]], 
                    [[-19.4, -6.245, 2.25535], [-18.57, -3.98599, 7.43642], [-21.7866, -3.88311, 5.84594]], 
                    [[-19.4, -6.245, 2.25535], [-21.7866, -3.88311, 5.84594], [-22.5459, -5.67178, 3.26823]], 
                    [[-16.8982, -7.53232, 0.154603], [-18.57, -3.98599, 7.43642], [-19.4, -6.245, 2.25535]], 
                    [[-16.8982, -7.53232, 0.154603], [-19.4, -6.245, 2.25535], [-19.5347, -7.86917, -0.858877]], 
                    [[-16.8982, -7.53232, 0.154603], [-15.708, -5.54543, 4.44554], [-18.57, -3.98599, 7.43642]], 
                    [[-14.1538, -7.05154, 0.775304], [-12.5076, -4.70516, 7.05081], [-15.708, -5.54543, 4.44554]], 
                    [[-10.0696, -6.43625, 0.890841], [-12.5076, -4.70516, 7.05081], [-14.1538, -7.05154, 0.775304]], 
                    [[-10.0696, -6.43625, 0.890841], [-14.1538, -7.05154, 0.775304], [-11.9102, -7.33789, -1.05223]], 
                    [[-3.37552, -2.64214, 4.56739], [-12.5076, -4.70516, 7.05081], [-7.65045, -5.63701, 0.808641]], 
                    [[-3.37552, -2.64214, 4.56739], [-7.65045, -5.63701, 0.808641], [-3.5493, -4.16283, 1.64701]], 
                    [[-7.65045, -5.63701, 0.808641], [-12.5076, -4.70516, 7.05081], [-10.0696, -6.43625, 0.890841]], 
                    [[-7.57318, -3.08223, 7.54741], [-3.37552, -2.64214, 4.56739], [-4.88831, -2.53587, 6.21548]], 
                    [[-7.57318, -3.08223, 7.54741], [-12.5076, -4.70516, 7.05081], [-3.37552, -2.64214, 4.56739]], 
                    [[-9.10072, -3.69314, 9.92887], [-12.5076, -4.70516, 7.05081], [-7.57318, -3.08223, 7.54741]], 
                    [[-12.0915, -4.37305, 10.0586], [-12.5076, -4.70516, 7.05081], [-9.10072, -3.69314, 9.92887]], 
                    [[-13.2151, -5.13548, 12.2527], [-14.1394, -3.95131, 10.5939], [-12.0915, -4.37305, 10.0586]], 
                    [[-14.4278, -7.38663, 14.6584], [-14.1394, -3.95131, 10.5939], [-13.2151, -5.13548, 12.2527]], 
                    [[-14.4278, -7.38663, 14.6584], [-13.2151, -5.13548, 12.2527], [-13.1871, -6.54963, 14.0902]], 
                    [[-17.0974, -4.01322, 12.7424], [-16.3662, -3.21763, 11.2521], [-14.4278, -7.38663, 14.6584]], 
                    [[-16.3566, -6.90685, 14.8325], [-14.4278, -7.38663, 14.6584], [-16.1484, -8.1403, 15.1548]], 
                    [[-17.0974, -4.01322, 12.7424], [-14.4278, -7.38663, 14.6584], [-16.3566, -6.90685, 14.8325]], 
                    [[-16.6929, -2.15937, 11.4769], [-16.3662, -3.21763, 11.2521], [-17.0974, -4.01322, 12.7424]], 
                    [[-17.2145, 3.33202, 13.5707], [-16.3662, -3.21763, 11.2521], [-16.6929, -2.15937, 11.4769]], 
                    [[-17.2145, 3.33202, 13.5707], [-17.3345, 0.061792, 12.6475], [-17.8479, 1.29501, 13.2145]], 
                    [[-17.2145, 3.33202, 13.5707], [-16.6929, -2.15937, 11.4769], [-17.3345, 0.061792, 12.6475]], 
                    [[-15.9671, 2.06121, 14.3985], [-15.8748, -0.698062, 11.5793], [-17.2145, 3.33202, 13.5707]], 
                    [[-15.3312, 3.67678, 14.1878], [-16.6952, 5.65451, 14.6441], [-16.0587, 8.65002, 14.8581]], 
                    [[-15.3312, 3.67678, 14.1878], [-17.2145, 3.33202, 13.5707], [-16.6952, 5.65451, 14.6441]], 
                    [[-15.9671, 2.06121, 14.3985], [-17.2145, 3.33202, 13.5707], [-15.3312, 3.67678, 14.1878]], 
                    [[-16.2749, -0.47657, 14.7614], [-15.8748, -0.698062, 11.5793], [-15.9671, 2.06121, 14.3985]], 
                    [[-16.2749, -0.47657, 14.7614], [-17.6241, -2.16175, 14.4102], [-15.8748, -0.698062, 11.5793]], 
                    [[-16.8343, -2.18393, 16.1611], [-17.6241, -2.16175, 14.4102], [-16.2749, -0.47657, 14.7614]], 
                    [[-21.1203, -4.32993, 16.2085], [-17.3167, -1.91468, 13.0492], [-17.6241, -2.16175, 14.4102]], 
                    [[-21.1203, -4.32993, 16.2085], [-17.6241, -2.16175, 14.4102], [-19.521, -3.94661, 17.4997]], 
                    [[-20.6865, -3.21803, 14.2324], [-17.3167, -1.91468, 13.0492], [-21.1203, -4.32993, 16.2085]], 
                    [[-23.8723, -3.27124, 17.3983], [-21.8011, -4.6503, 16.6151], [-23.8105, -4.49594, 18.3471]], 
                    [[-23.8723, -3.27124, 17.3983], [-21.1203, -4.32993, 16.2085], [-21.8011, -4.6503, 16.6151]], 
                    [[-20.6865, -3.21803, 14.2324], [-21.1203, -4.32993, 16.2085], [-23.8723, -3.27124, 17.3983]], 
                    [[-20.6865, -3.21803, 14.2324], [-19.0454, -2.66264, 12.3056], [-17.3167, -1.91468, 13.0492]], 
                    [[-18.57, -3.98599, 7.43642], [-15.708, -5.54543, 4.44554], [-12.5076, -4.70516, 7.05081]], 
                    [[-18.57, -3.98599, 7.43642], [-12.5076, -4.70516, 7.05081], [-16.6673, -3.1262, 11.2656]], 
                    [[-12.0915, -4.37305, 10.0586], [-14.1394, -3.95131, 10.5939], [-12.5076, -4.70516, 7.05081]], 
                    [[-14.1394, -3.95131, 10.5939], [-16.6673, -3.1262, 11.2656], [-12.5076, -4.70516, 7.05081]], 
                    [[-14.4278, -7.38663, 14.6584], [-16.3662, -3.21763, 11.2521], [-14.1394, -3.95131, 10.5939]], 
                    [[-16.3662, -3.21763, 11.2521], [-16.6673, -3.1262, 11.2656], [-14.1394, -3.95131, 10.5939]], 
                    [[-17.2145, 3.33202, 13.5707], [-15.8748, -0.698062, 11.5793], [-16.3662, -3.21763, 11.2521]], 
                    [[-15.8748, -0.698062, 11.5793], [-16.6673, -3.1262, 11.2656], [-16.3662, -3.21763, 11.2521]], 
                    [[-17.3167, -1.91468, 13.0492], [-15.8748, -0.698062, 11.5793], [-17.6241, -2.16175, 14.4102]], 
                    [[-17.3167, -1.91468, 13.0492], [-16.6673, -3.1262, 11.2656], [-15.8748, -0.698062, 11.5793]], 
                    [[-19.0454, -2.66264, 12.3056], [-16.6673, -3.1262, 11.2656], [-17.3167, -1.91468, 13.0492]], 
                    [[-18.57, -3.98599, 7.43642], [-16.6673, -3.1262, 11.2656], [-19.0454, -2.66264, 12.3056]], 
                    [[-18.57, -3.98599, 7.43642], [-16.6673, -3.1262, 11.2656], [-19.0454, -2.66264, 12.3056]]]
                surface = viewerInstance.renderSurface(1, coords, 0.9);
                // const coord2 = [[[-18.57, -3.98599, 7.43642], [-16.6673, -3.1262, 11.2656], [-19.0454, -2.66264, 12.3056]]]
                // surface2 = viewerInstance.renderSurface(2, coords, true, 0,255,0);
                bond = viewerInstance.renderBond(1, [4.414, 2.348, 15.104], [5.51, -2.905, 16.147])
                // bond2 = viewerInstance.renderBond([5.414, 5.348, 15.104], [5.51, -2.905, 16.147])
      }
      viewerInstance.events.loadComplete.subscribe((e) => { 
                

                
            })

      // document.addEventListener('PDB.molstar.mouseover', (e) => { 
      //   //do something on event 
      //   console.log(e)
      // });
      
    </script>
  </body>

</html>